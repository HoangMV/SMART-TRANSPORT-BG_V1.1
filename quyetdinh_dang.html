<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quyết Định Thành Lập Trong Đảng</title>
    <!-- Thêm các thư viện cần thiết -->
    <script src="https://unpkg.com/html-docx-js/dist/html-docx.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.37.11/docxtemplater.js"></script>
    <script src="https://unpkg.com/pizzip@3.1.4/dist/pizzip.js"></script>
    <style>
        @page {
            size: A4;
            margin: 1.5cm 1.5cm 1.5cm 2.5cm;
        }

        @page landscape {
            size: A4 landscape;
            margin: 1cm 1.5cm 1cm 2cm;
        }

        body {
            font-family: 'Times New Roman', serif;
            font-size: 14pt;
            line-height: 1.3;
            margin: 0;
            padding: 0;
        }

        .page {
            box-sizing: border-box;
            padding: 0;
            position: relative;
            width: 21cm;
            height: 29.7cm;
            margin: 0 auto;
            background-color: white;
        }

        .landscape-page {
            width: 31.7cm;
            height: 21cm;
            page: landscape;
        }

        .header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0;
            align-items: flex-start;
        }

        .header-left {
            text-align: center;
            width: 40%;
        }

        .header-right {
            text-align: center;
            width: 60%;
            font-weight: bold;
        }

        .document-number {
            margin-top: 10px;
        }

        .title {
            text-align: center;
            font-weight: bold;
            margin: 20px 0;
            position: relative;
            font-weight: bold;
        }

        .title::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: -5px;
            transform: translateX(-50%);
            width: 30%;
            height: 1.5px;
            background-color: black;
        }

        .underline-title,
        .underline-title-full {
            display: inline-block;
            position: relative;
            font-weight: bold;
        }

        .underline-title::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: -5px;
            transform: translateX(-50%);
            width: 50%;
            height: 1.5px;
            background-color: black;
        }

        .underline-title-full::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: -5px;
            transform: translateX(-50%);
            width: 100%;
            height: 1.5px;
            background-color: black;
        }

        .decision-title {
            text-align: center;
            font-weight: bold;
            margin: 20px 0;
        }

        .italic-text {
            font-style: italic;
            text-align: justify;
            margin: 10px 0;
        }

        .decision-section {
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
        }

        .article {
            text-indent: 30px;
            margin: 10px 0;
        }

        .article-content {
            margin: 0;
            text-align: justify;
            font-weight: normal;
        }

        .closing-paragraph {
            margin: 10px 0;
            text-align: justify;
            text-indent: 30px;
        }

        .footer {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .footer-left {
            width: 60%;
        }

        .footer-right {
            width: 40%;
            text-align: center;
        }

        .signature-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .signature-name {
            font-weight: bold;
            margin-top: 100px;
        }

        .recipient-list {
            list-style-type: none;
            padding-left: 0;
            margin-top: 5px;
        }

        .recipient-item {
            margin: 1px 0;
        }

        .print-button {
            position: fixed;
            top: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            z-index: 1000;
        }

        .print-button:hover {
            background-color: #45a049;
        }

        @media print {
            .print-button {
                display: none;
            }

            body {
                margin: 0;
                padding: 0;
            }

            .page {
                margin: 0;
                padding: 0;
                border: none;
            }

            .page-break {
                page-break-after: always;
            }
        }

        .text-block {
            text-align: justify;
            text-indent: 30px;
        }

        .table-container {
            width: 100%;
            margin: 20px auto;
        }

        .table-title {
            text-align: center;
            font-weight: bold;
            font-size: 16pt;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid black;
        }

        th,
        td {
            border: 1px solid black;
            padding: 5px;
            text-align: center;
            vertical-align: middle;
            font-size: 12pt;
        }

        th {
            font-weight: bold;
            background-color: #f2f2f2;
        }

        .text-left {
            text-align: left;
        }

        #loading-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 20px;
            border-radius: 5px;
            z-index: 2000;
        }

        .hidden {
            display: none;
        }
    </style>
</head>

<body>
    <!-- Print Button -->
    <button class="print-button" onclick="window.print()" style="right: 150px;">In Tài Liệu</button>
    <button class="print-button" onclick="exportToWordTemplate()" style="right: 20px;">Xuất Word</button>

    <!-- Loading Message -->
    <div id="loading-message">Đang tải dữ liệu...</div>

    <!-- First page in portrait orientation -->
    <div class="page">
        <div class="document-container">
            <div class="header">
                <div class="header-left">
                    <div style="margin-bottom: 5px;">ĐẢNG BỘ UBND TỈNH <span id="tinh-header">BẮC NINH</span></div>
                    <div class="underline-title"><strong>ĐẢNG ỦY SỞ XÂY DỰNG</strong></div>
                    <div class="document-number">Số: <span id="so-quyet-dinh">______</span>/QĐ/ĐU</div>
                </div>
                <div class="header-right">
                    <div style="margin-bottom: 5px;">ĐẢNG CỘNG SẢN VIỆT NAM</div>
                    <div class="underline-title-full"><span class="underline-text"></span></div>
                    <div style="font-style: italic; font-weight: normal; margin-top: 10px; text-align: center;"
                        id="ngay-thang"><span id="tinh-footer">Bắc Ninh</span>, ngày &nbsp;&nbsp;&nbsp; tháng 7 năm 2025
                    </div>
                </div>
            </div>

            <div class="title">
                QUYẾT ĐỊNH<br>
                <span id="noi-dung-qd"></span>
            </div>

            <div class="text-block italic-text">
                Căn cứ Điều lệ Đảng Cộng sản Việt Nam; Quy định số 294-QĐ-QĐ/TW ngày 26/5/2025 của Ban Chấp hành Trung
                ương về thi hành Điều lệ Đảng;
            </div>

            <div class="text-block italic-text">
                Căn cứ Quyết định số - QĐ/ĐU ngày 01/7/2025 của Đảng ủy Ủy ban nhân dân tỉnh về thành lập Đảng bộ Sở Xây
                dựng tỉnh Bắc Ninh;
            </div>

            <div class="text-block italic-text">
                Căn cứ Quy chế làm việc số - QC/ĐU ngày 01/7/2025 của Ban Chấp hành Đảng bộ Sở Xây dựng tỉnh Bắc Ninh
                nhiệm kỳ 2025-2030;
            </div>

            <div class="text-block italic-text" id="can-cu-khac">
                <!-- Căn cứ khác sẽ được điền từ dữ liệu -->
            </div>

            <div class="text-block italic-text">
                Xét đề nghị của Văn phòng Đảng ủy,
            </div>

            <div class="decision-section">
                BAN CHẤP HÀNH ĐẢNG BỘ SỞ XÂY DỰNG<br>
                QUYẾT ĐỊNH
            </div>

            <div class="article">
                <strong>Điều 1.</strong> Thành lập <strong><span id="chi-bo-2">Chi bộ Văn phòng</span></strong>
                trực thuộc Đảng ủy Sở Xây dựng trên cơ sở số đảng viên công tác tại Văn phòng Sở <em>(có danh sách đảng
                    viên kèm theo).</em>
            </div>

            <div class="article">
                <strong>Điều 2.</strong> Chỉ định Chi ủy, chức danh Bí thư, Phó Bí thư <span id="chi-bo-3">Chi bộ
                    Văn phòng</span>, nhiệm kỳ <span id="nhiem-ky"></span> gồm các đồng chí có tên sau:
            </div>

            <div style="margin-left: 30px;">
                <div id="danh-sach-chi-uy">
                    <!-- Danh sách chi ủy sẽ được điền từ dữ liệu -->
                </div>
            </div>

            <div class="article">
                <strong>Điều 3.</strong> Chi ủy <span id="chi-bo-4">Chi bộ Văn phòng</span> có trách nhiệm lãnh
                đạo, chỉ đạo, tổ chức hoạt động của chi bộ theo đúng quy định của Điều lệ Đảng và các văn bản quy định,
                hướng dẫn hiện hành.
            </div>

            <div class="article">
                <strong>Điều 4.</strong> Quyết định này có hiệu lực từ ngày ký.
            </div>

            <div class="closing-paragraph">
                Văn phòng Đảng ủy Sở, <span id="chi-bo-5">Chi bộ Văn phòng</span>, các đồng chí có tên tại Điều 1,
                Điều 2 và cơ quan, đơn vị có liên quan căn cứ Quyết định thực hiện.
            </div>

            <div class="footer">
                <div class="footer-left">
                    <div><strong>Nơi nhận:</strong></div>
                    <div class="recipient-item">- Thường trực Đảng ủy UBND tỉnh (báo cáo),</div>
                    <div class="recipient-item">- BTC Đảng ủy UBND tỉnh (báo cáo),</div>
                    <div class="recipient-item">- Như Điều 4,</div>
                    <div class="recipient-item">- Các đồng chí Đảng ủy viên,</div>
                    <div class="recipient-item">- Lãnh đạo Sở,</div>
                    <div class="recipient-item">- Lưu ĐU.</div>
                </div>
                <div class="footer-right">
                    <div class="signature-title">T/M ĐẢNG ỦY</div>
                    <div class="signature-title">BÍ THƯ</div>
                    <div style="margin-top: 80px;"></div>
                    <div class="signature-name" id="nguoi-ky">Nguyễn Việt Hùng</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Page break between pages -->
    <div class="page-break"></div>

    <!-- Second page - Danh sách đảng viên -->
    <div class="page">
        <div class="table-container">
            <div class="table-title">
                DANH SÁCH<br>
                Đảng viên <span id="chi-bo-table">Chi bộ Văn phòng</span> trực thuộc Đảng ủy Sở Xây dựng tỉnh <span
                    id="tinh-table">Bắc Ninh</span>
            </div>
            <div style="text-align: center; font-style: italic; margin-bottom: 20px;">
                <em>(Kèm theo Quyết định số <span id="so-qd-table">-QĐ/ĐU</span> ngày <span
                        id="ngay-qd-table">01/7/2025</span></em><br>
                <em>của Đảng ủy Sở Xây dựng tỉnh <span id="tinh-table-2">Bắc Ninh</span>)</em>
            </div>
            <div style="text-align: center; margin-bottom: 20px;">
                -----
            </div>

            <table>
                <thead>
                    <tr>
                        <th style="width: 5%;">STT</th>
                        <th style="width: 20%;">Họ và tên</th>
                        <th style="width: 8%;">Năm sinh</th>
                        <th style="width: 15%;">Chức vụ đảng</th>
                        <th style="width: 25%;">Chức vụ chính quyền</th>
                        <th style="width: 12%;">Ghi chú</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- Table rows will be dynamically populated -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Constants for AppSheet connection
        const appId = '0cb8b18f-8832-47f8-85ce-85d486abbda8';
        const accessKey = 'V2-EjKXF-e5j4a-7oCiN-jf5we-CN1H1-wWqOV-yyFoU-tNKFW';
        const region = 'www';

        // Biến toàn cục để lưu dữ liệu
        let globalQuyetDinhData = null;
        let globalChiTietData = null;

        // Function to get ID from URL parameter
        function getQuyetDinhIDFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('ID_QD');
        }

        // Generic function to make API calls
        async function callAPI(tableName, selector) {
            const response = await fetch(`https://${region}.appsheet.com/api/v2/apps/${appId}/tables/${tableName}/Action`, {
                method: 'POST',
                headers: {
                    'ApplicationAccessKey': accessKey,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    Action: 'Find',
                    Properties: {
                        Selector: selector
                    }
                })
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status} for table: ${tableName}`);
            }

            return await response.json();
        }

        // Main function to fetch data
        async function fetchData() {
            const idQuyetDinh = getQuyetDinhIDFromURL();
            console.log("ID from URL:", idQuyetDinh);

            if (!idQuyetDinh) {
                hideLoadingMessage();
                alert('Không tìm thấy IDQuyetDinh trong URL.');
                return;
            }

            try {
                // Prepare API calls
                const currentDate = new Date().toISOString();

                const apiCalls = [
                    // 1. Fetch QuyetdinhTrongDang data for page 1
                    callAPI('QuyetdinhTrongDang', `Filter(QuyetdinhTrongDang, [ID_QD] = "${idQuyetDinh}")`),

                    // 2. Fetch QuyetDinhTrongDang_ChiTiet data for page 2
                    callAPI('QuyetDinhTrongDang_ChiTiet', `Filter(QuyetDinhTrongDang_ChiTiet, [Ref_QD_Dang] = "${idQuyetDinh}")`)
                ];

                // Execute API calls
                console.log("Bắt đầu gọi API...");
                const [quyetDinhData, chitietData] = await Promise.all(apiCalls);

                console.log("QuyetDinh data:", quyetDinhData);
                console.log("ChiTiet data:", chitietData);

                // Store data globally
                globalQuyetDinhData = quyetDinhData;
                globalChiTietData = chitietData;

                if (!quyetDinhData || quyetDinhData.length === 0) {
                    hideLoadingMessage();
                    alert('Không tìm thấy dữ liệu quyết định với ID: ' + idQuyetDinh);
                    return;
                }

                if (!chitietData || chitietData.length === 0) {
                    hideLoadingMessage();
                    alert('Không tìm thấy dữ liệu chi tiết cho ID quyết định: ' + idQuyetDinh);
                    return;
                }

                // Populate page 1 with data
                populateQuyetDinhData(quyetDinhData[0]);

                // Populate page 2 with data
                populateChiTietData(chitietData);

                // Hide loading message
                hideLoadingMessage();

            } catch (error) {
                console.error('Lỗi:', error);
                hideLoadingMessage();
                alert('Đã xảy ra lỗi khi lấy dữ liệu: ' + error.message);
            }
        }

        // Populate QuyetdinhTrongDang data for page 1
        function populateQuyetDinhData(data) {

            // Update TrichYeu
            if (data.TrichYeu) {
                document.getElementById('noi-dung-qd').textContent = data.TrichYeu || '';

            }

            // Update TenChiBo
            if (data.TenChiBo) {
                document.getElementById('chi-bo-2').textContent = data.TenChiBo;
                document.getElementById('chi-bo-3').textContent = data.TenChiBo;
                document.getElementById('chi-bo-4').textContent = data.TenChiBo;
                document.getElementById('chi-bo-5').textContent = data.TenChiBo;
                document.getElementById('chi-bo-table').textContent = data.TenChiBo;

            }

            // Update Số quyết định
            // if (data.SoQuyetDinh_Dang) {
            //     document.getElementById('so-quyet-dinh').textContent = data.SoQuyetDinh_Dang;
            //     document.getElementById('so-qd-table').textContent = data.SoQuyetDinh_Dang + '/QĐ/ĐU';
            // }

            // // Format date (DD/MM/YYYY) with administrative rules
            // if (data.NgayKy) {
            //     const date = new Date(data.NgayKy);
            //     const day = date.getDate().toString().padStart(2, '0');
            //     const month = date.getMonth() + 1;
            //     const formattedMonth = month <= 2 ?
            //         month.toString().padStart(2, '0') :
            //         month.toString();
            //     const year = date.getFullYear();

            //     document.getElementById('ngay-thang').innerHTML =
            //         `<span id="tinh-footer">${tenTinh}</span>, ngày ${day} tháng ${formattedMonth} năm ${year}`;

            //     document.getElementById('ngay-qd-table').textContent = `${day}/${formattedMonth}/${year}`;
            // } else {
            //     document.getElementById('tinh-footer').textContent = tenTinh;
            // }

            // Update Căn cứ ban hành quyết định khác
            if (data.CanCuBanHanhQuyetDinhKhac) {
                document.getElementById('can-cu-khac').textContent = data.CanCuBanHanhQuyetDinhKhac + ';';
            }

            // Update Nhiệm kỳ
            if (data.NhiemKy) {
                document.getElementById('nhiem-ky').textContent = data.NhiemKy;
            }

            // Update Người ký
            if (data.TenNguoiKy) {
                document.getElementById('nguoi-ky').textContent = data.TenNguoiKy;
            }
        }

        // Populate QuyetDinhTrongDang_ChiTiet data for page 2
        function populateChiTietData(data) {
            const tableBody = document.getElementById('table-body');
            tableBody.innerHTML = '';

            // Tạo danh sách chi ủy
            const chiUyList = document.getElementById('danh-sach-chi-uy');

            chiUyList.innerHTML = '';

            data.forEach((item, index) => {
                // Thêm vào bảng danh sách đảng viên
                const row = document.createElement('tr');
                const hoTen = (item.HoTenNhanSu || '').replace(/^(Ông|Bà)\s+/i, '');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td class="text-left">${hoTen || ''}</td>
                    <td>${item.NgaySinhNhanSu || ''}</td>
                    <td class="text-left">${item.TenChucVuDang || ''}</td>
                    <td class="text-left">${item.TenChucVuChinhQuyen || ''} ${item.TenDonViCongTac || ''}</td>
                    <td>${item.GhiChu || ''}</td>
                `;
                tableBody.appendChild(row);

                // Nếu có chức vụ đảng là Chi ủy viên, Bí thư, Phó Bí thư thì thêm vào danh sách chi ủy
                if (item.TenChucVuDang && (
                    item.TenChucVuDang.includes('Bí thư') ||
                    item.TenChucVuDang.includes('Phó Bí thư') ||
                    item.TenChucVuDang.includes('Chi ủy viên')
                )) {
                    const chiUyItem = document.createElement('div');
                    chiUyItem.style.margin = '5px 0';
                    const hoTen = (item.HoTenNhanSu || '').replace(/^(Ông|Bà)\s+/i, '');
                    chiUyItem.innerHTML = `${index + 1}. Đồng chí ${hoTen}, ${item.TenChucVuDang} Chi bộ, ${item.TenChucVuChinhQuyen || ''}, ${item.TenDonViCongTac};`;
                    chiUyList.appendChild(chiUyItem);
                }
            });
        }

        // Hide loading message
        function hideLoadingMessage() {
            document.getElementById('loading-message').classList.add('hidden');
        }

        // Function to export to Word using template
        // Function to export to Word using template
        async function exportToWordTemplate() {
            try {
                document.getElementById('loading-message').classList.remove('hidden');

                // Check if we have data
                if (!globalQuyetDinhData || !globalChiTietData) {
                    alert('Dữ liệu chưa được tải. Vui lòng đợi dữ liệu tải xong.');
                    document.getElementById('loading-message').classList.add('hidden');
                    return;
                }

                // Chuẩn bị dữ liệu cho template Word
                const quyetDinh = globalQuyetDinhData[0];

                // Format ngày tháng with administrative rules
                let ngayKy = '';
                let thangKy = '';
                let namKy = '';
                let ngayThangNam = '';

                if (quyetDinh.NgayKy) {
                    const date = new Date(quyetDinh.NgayKy);
                    ngayKy = date.getDate().toString().padStart(2, '0');
                    const month = date.getMonth() + 1;
                    thangKy = month <= 2 ? month.toString().padStart(2, '0') : month.toString();
                    namKy = date.getFullYear();
                    ngayThangNam = `${ngayKy}/${thangKy}/${namKy}`;
                }

                // Chuẩn bị danh sách đảng viên cho template
                const dangVienList = globalChiTietData.map((item, index) => {
                    const hoTen = (item.HoTenNhanSu || '').replace(/^(Ông|Bà)\s+/i, '');
                    return {
                        stt: (index + 1).toString(),
                        ho_ten: hoTen,
                        nam: item.NgaySinhNhanSu || '',
                        chuc_vu_dang: item.TenChucVuDang || '',
                        chuc_vu_chinh_quyen: item.TenChucVuChinhQuyen || '',
                        don_vi_cong_tac: item.TenDonViCongTac || '', // Thêm dòng này
                        gc: item.GhiChu || ''
                    };
                });

                // Chuẩn bị danh sách chi ủy
                const chiUyList = globalChiTietData
                    .filter(item => item.TenChucVuDang && (
                        item.TenChucVuDang.includes('Bí thư') ||
                        item.TenChucVuDang.includes('Phó Bí thư') ||
                        item.TenChucVuDang.includes('Chi ủy viên')
                    ))
                    .map((item, index) => {
                        const hoTen = (item.HoTenNhanSu || '').replace(/^(Ông|Bà)\s+/i, '');
                        return {
                            stt: (index + 1).toString(),
                            ho_ten: hoTen,
                            chuc_vu_dang: item.TenChucVuDang || '',
                            chuc_vu_chinh_quyen: item.TenChucVuChinhQuyen || '',
                            don_vi_cong_tac: item.TenDonViCongTac || '',
                            chi_uy_text: `${index + 1}. Đồng chí ${hoTen}, ${item.TenChucVuDang} Chi bộ, ${item.TenChucVuChinhQuyen || ''}, ${item.TenDonViCongTac || ''};`
                        };
                    });

                // Tải template Word từ GitHub
                const response = await fetch('https://hoangmv.github.io/templates_qd/quyet_dinh_dang_template.docx');
                if (!response.ok) {
                    throw new Error('Không thể tải template Word');
                }
                const templateContent = await response.arrayBuffer();

                // Tạo PizZip và docxtemplater
                const zip = new PizZip(templateContent);
                const doc = new window.docxtemplater(zip, {
                    paragraphLoop: true,
                    linebreaks: true
                });

                // Đặt dữ liệu vào template
                const data = {
                    // Thông tin header
                    tinh_header: 'BẮC NINH',
                    tinh_footer: 'Bắc Ninh',
                    tinh_table: 'Bắc Ninh',

                    // Thông tin quyết định
                    so_quyet_dinh: quyetDinh.SoQuyetDinh_Dang || '______',
                    trich_yeu: quyetDinh.TrichYeu || '',
                    ten_chi_bo: quyetDinh.TenChiBo || '',

                    // Thông tin ngày tháng
                    ngay_ky: ngayKy,
                    thang_ky: thangKy,
                    nam_ky: namKy,
                    ngay_thang_nam: ngayThangNam,

                    // Căn cứ và thông tin khác
                    can_cu_khac: quyetDinh.CanCuBanHanhQuyetDinhKhac || '',
                    nhiem_ky: quyetDinh.NhiemKy || '',
                    nguoi_ky: quyetDinh.TenNguoiKy || 'Nguyễn Việt Hùng',

                    // Danh sách
                    dang_vien_list: dangVienList,
                    chi_uy_list: chiUyList,

                    // Thống kê
                    so_dang_vien: dangVienList.length.toString(),
                    so_chi_uy: chiUyList.length.toString()
                };

                console.log('Data for template:', data); // Debug log

                // Render template
                doc.setData(data);
                doc.render();

                // Tạo và tải file
                const blob = doc.getZip().generate({
                    type: "blob",
                    mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                });

                const fileName = `Quyet_dinh_thanh_lap_${quyetDinh.TenChiBo || 'Chi_bo'}_${quyetDinh.SoQuyetDinh_Dang || 'new'}.docx`;
                saveAs(blob, fileName);

                console.log('File Word đã được tạo thành công!');

            } catch (error) {
                console.error('Lỗi khi xuất file Word:', error);
                if (error.properties && error.properties.errors) {
                    console.log('Template Error details:', error.properties.errors);
                }
                alert('Có lỗi khi xuất file Word: ' + error.message);
            } finally {
                document.getElementById('loading-message').classList.add('hidden');
            }
        }

        // Load data when page loads
        document.addEventListener('DOMContentLoaded', fetchData);

        // Disable right-click and F12
        document.addEventListener('contextmenu', function (e) {
            e.preventDefault();
        }, false);

        document.onkeydown = function (e) {
            if (e.keyCode == 123) {
                return false;
            }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
                return false;
            }
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
                return false;
            }
            if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
                return false;
            }
        };
    </script>
</body>

</html>